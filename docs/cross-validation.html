<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Topic 4 Cross-validation | STAT 253: Statistical Machine Learning</title>
  <meta name="description" content="This is the class website for Statistical Machine Learning at Macalester College." />
  <meta name="generator" content="bookdown 0.32 and GitBook 2.6.7" />

  <meta property="og:title" content="Topic 4 Cross-validation | STAT 253: Statistical Machine Learning" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is the class website for Statistical Machine Learning at Macalester College." />
  <meta name="github-repo" content="lmyint/253_spring_2021" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Topic 4 Cross-validation | STAT 253: Statistical Machine Learning" />
  
  <meta name="twitter:description" content="This is the class website for Statistical Machine Learning at Macalester College." />
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="overfitting.html"/>
<link rel="next" href="homework-1.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="custom_styles.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href = "./">STAT 253: Statistical Machine Learning</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome!</a></li>
<li class="chapter" data-level="" data-path="schedule.html"><a href="schedule.html"><i class="fa fa-check"></i>Schedule</a></li>
<li class="chapter" data-level="" data-path="learning-goals.html"><a href="learning-goals.html"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="part"><span><b>I R</b></span></li>
<li class="chapter" data-level="" data-path="r-and-rstudio-setup.html"><a href="r-and-rstudio-setup.html"><i class="fa fa-check"></i>R and RStudio Setup</a>
<ul>
<li class="chapter" data-level="" data-path="r-and-rstudio-setup.html"><a href="r-and-rstudio-setup.html#troubleshooting"><i class="fa fa-check"></i>Troubleshooting</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-resources.html"><a href="r-resources.html"><i class="fa fa-check"></i>R Resources</a>
<ul>
<li class="chapter" data-level="" data-path="r-resources.html"><a href="r-resources.html#outside-resources"><i class="fa fa-check"></i>Outside resources</a></li>
<li class="chapter" data-level="" data-path="r-resources.html"><a href="r-resources.html#example-code"><i class="fa fa-check"></i>Example code</a></li>
</ul></li>
<li class="part"><span><b>II Introductions</b></span></li>
<li class="chapter" data-level="1" data-path="introductions.html"><a href="introductions.html"><i class="fa fa-check"></i><b>1</b> Introductions</a>
<ul>
<li class="chapter" data-level="" data-path="introductions.html"><a href="introductions.html#explorations"><i class="fa fa-check"></i>Explorations</a>
<ul>
<li class="chapter" data-level="" data-path="introductions.html"><a href="introductions.html#phase-1"><i class="fa fa-check"></i>Phase 1</a></li>
<li class="chapter" data-level="" data-path="introductions.html"><a href="introductions.html#phase-2"><i class="fa fa-check"></i>Phase 2</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Regression: Evaluation</b></span></li>
<li class="chapter" data-level="2" data-path="evaluating-regression-models.html"><a href="evaluating-regression-models.html"><i class="fa fa-check"></i><b>2</b> Evaluating Regression Models</a>
<ul>
<li class="chapter" data-level="" data-path="evaluating-regression-models.html"><a href="evaluating-regression-models.html#learning-goals-1"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="evaluating-regression-models.html"><a href="evaluating-regression-models.html#exercises"><i class="fa fa-check"></i>Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="evaluating-regression-models.html"><a href="evaluating-regression-models.html#context"><i class="fa fa-check"></i>Context</a></li>
<li class="chapter" data-level="" data-path="evaluating-regression-models.html"><a href="evaluating-regression-models.html#class-investigations"><i class="fa fa-check"></i>Class investigations</a></li>
<li class="chapter" data-level="" data-path="evaluating-regression-models.html"><a href="evaluating-regression-models.html#exercise-1"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="evaluating-regression-models.html"><a href="evaluating-regression-models.html#exercise-2"><i class="fa fa-check"></i>Exercise 2</a></li>
<li class="chapter" data-level="" data-path="evaluating-regression-models.html"><a href="evaluating-regression-models.html#exercise-3"><i class="fa fa-check"></i>Exercise 3</a></li>
<li class="chapter" data-level="" data-path="evaluating-regression-models.html"><a href="evaluating-regression-models.html#exercise-4"><i class="fa fa-check"></i>Exercise 4</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="overfitting.html"><a href="overfitting.html"><i class="fa fa-check"></i><b>3</b> Overfitting</a>
<ul>
<li class="chapter" data-level="" data-path="overfitting.html"><a href="overfitting.html#learning-goals-2"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="overfitting.html"><a href="overfitting.html#exercises-1"><i class="fa fa-check"></i>Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="overfitting.html"><a href="overfitting.html#exercise-1-1"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="overfitting.html"><a href="overfitting.html#exercise-2-1"><i class="fa fa-check"></i>Exercise 2</a></li>
<li class="chapter" data-level="" data-path="overfitting.html"><a href="overfitting.html#check-in-with-groupmates"><i class="fa fa-check"></i>Check-in with groupmates</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="cross-validation.html"><a href="cross-validation.html"><i class="fa fa-check"></i><b>4</b> Cross-validation</a>
<ul>
<li class="chapter" data-level="" data-path="cross-validation.html"><a href="cross-validation.html#learning-goals-3"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="cross-validation.html"><a href="cross-validation.html#exercises-2"><i class="fa fa-check"></i>Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="cross-validation.html"><a href="cross-validation.html#exercise-1-cross-validation-concepts"><i class="fa fa-check"></i>Exercise 1: Cross-validation concepts</a></li>
<li class="chapter" data-level="" data-path="cross-validation.html"><a href="cross-validation.html#exercise-2-cross-validation-with-tidymodels"><i class="fa fa-check"></i>Exercise 2: Cross-validation with <code>tidymodels</code></a></li>
<li class="chapter" data-level="" data-path="cross-validation.html"><a href="cross-validation.html#exercise-3-looking-at-the-evaluation-metrics"><i class="fa fa-check"></i>Exercise 3: Looking at the evaluation metrics</a></li>
<li class="chapter" data-level="" data-path="cross-validation.html"><a href="cross-validation.html#exercise-4-practical-issues-choosing-the-number-of-folds"><i class="fa fa-check"></i>Exercise 4: Practical issues: choosing the number of folds</a></li>
<li class="chapter" data-level="" data-path="cross-validation.html"><a href="cross-validation.html#digging-deeper"><i class="fa fa-check"></i>Digging deeper</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>IV Homework</b></span></li>
<li class="chapter" data-level="" data-path="homework-1.html"><a href="homework-1.html"><i class="fa fa-check"></i>Homework 1</a>
<ul>
<li class="chapter" data-level="" data-path="homework-1.html"><a href="homework-1.html#project-work"><i class="fa fa-check"></i>Project Work</a></li>
<li class="chapter" data-level="" data-path="homework-1.html"><a href="homework-1.html#portfolio-work"><i class="fa fa-check"></i>Portfolio Work</a></li>
<li class="chapter" data-level="" data-path="homework-1.html"><a href="homework-1.html#metacognitive-reflection"><i class="fa fa-check"></i>Metacognitive Reflection</a></li>
</ul></li>
<li class="part"><span><b>V Project</b></span></li>
<li class="chapter" data-level="" data-path="final-project.html"><a href="final-project.html"><i class="fa fa-check"></i>Final Project</a>
<ul>
<li class="chapter" data-level="" data-path="final-project.html"><a href="final-project.html#requirements"><i class="fa fa-check"></i>Requirements</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">STAT 253: Statistical Machine Learning</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="cross-validation" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Topic 4</span> Cross-validation<a href="cross-validation.html#cross-validation" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="learning-goals-3" class="section level2 unnumbered hasAnchor">
<h2>Learning Goals<a href="cross-validation.html#learning-goals-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Explain why training/in-sample model evaluation metrics can provide a misleading view of true test/out-of-sample performance</li>
<li>Accurately describe all steps of cross-validation to estimate the test/out-of-sample version of a model evaluation metric</li>
<li>Explain what role CV has in a predictive modeling analysis and its connection to overfitting</li>
<li>Explain the pros/cons of higher vs. lower # of folds in CV in terms of sample size and computing time</li>
<li>Implement cross-validation in R using the <code>tidymodels</code> package</li>
</ul>
<p><br><br><br></p>
</div>
<div id="exercises-2" class="section level2 unnumbered hasAnchor">
<h2>Exercises<a href="cross-validation.html#exercises-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>You can download a template RMarkdown file to start from <a href="template_rmds/04-cv.Rmd">here</a>.</strong></p>
<p>We’ll continue using the body fat percentage dataset from before. Our goal is to build a good predictive model of body fat percentage from body circumference measurements.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="cross-validation.html#cb32-1" aria-hidden="true"></a><span class="kw">library</span>(readr)</span>
<span id="cb32-2"><a href="cross-validation.html#cb32-2" aria-hidden="true"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb32-3"><a href="cross-validation.html#cb32-3" aria-hidden="true"></a><span class="kw">library</span>(dplyr)</span>
<span id="cb32-4"><a href="cross-validation.html#cb32-4" aria-hidden="true"></a><span class="kw">library</span>(tidymodels)</span>
<span id="cb32-5"><a href="cross-validation.html#cb32-5" aria-hidden="true"></a><span class="kw">tidymodels_prefer</span>()</span>
<span id="cb32-6"><a href="cross-validation.html#cb32-6" aria-hidden="true"></a></span>
<span id="cb32-7"><a href="cross-validation.html#cb32-7" aria-hidden="true"></a>bodyfat_train &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;https://www.dropbox.com/s/js2gxnazybokbzh/bodyfat_train.csv?dl=1&quot;</span>)</span>
<span id="cb32-8"><a href="cross-validation.html#cb32-8" aria-hidden="true"></a></span>
<span id="cb32-9"><a href="cross-validation.html#cb32-9" aria-hidden="true"></a><span class="co"># Remove the extraneous outcome variables (fatBrozek and density) and the</span></span>
<span id="cb32-10"><a href="cross-validation.html#cb32-10" aria-hidden="true"></a><span class="co"># redundant hip circumference variable (hipin = hip circ. in inches)</span></span>
<span id="cb32-11"><a href="cross-validation.html#cb32-11" aria-hidden="true"></a>bodyfat_train &lt;-<span class="st"> </span>bodyfat_train <span class="op">%&gt;%</span></span>
<span id="cb32-12"><a href="cross-validation.html#cb32-12" aria-hidden="true"></a><span class="st">    </span><span class="kw">select</span>(<span class="op">-</span>fatBrozek, <span class="op">-</span>density, <span class="op">-</span>hipin)</span></code></pre></div>
<p>Consider 4 models for body fat percentage:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="cross-validation.html#cb33-1" aria-hidden="true"></a>lm_spec &lt;-</span>
<span id="cb33-2"><a href="cross-validation.html#cb33-2" aria-hidden="true"></a><span class="st">    </span><span class="kw">linear_reg</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb33-3"><a href="cross-validation.html#cb33-3" aria-hidden="true"></a><span class="st">    </span><span class="kw">set_engine</span>(<span class="dt">engine =</span> <span class="st">&quot;lm&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb33-4"><a href="cross-validation.html#cb33-4" aria-hidden="true"></a><span class="st">    </span><span class="kw">set_mode</span>(<span class="st">&quot;regression&quot;</span>)</span>
<span id="cb33-5"><a href="cross-validation.html#cb33-5" aria-hidden="true"></a></span>
<span id="cb33-6"><a href="cross-validation.html#cb33-6" aria-hidden="true"></a>mod1 &lt;-<span class="st"> </span><span class="kw">fit</span>(lm_spec,</span>
<span id="cb33-7"><a href="cross-validation.html#cb33-7" aria-hidden="true"></a>            fatSiri <span class="op">~</span><span class="st"> </span>age<span class="op">+</span>weight<span class="op">+</span>neck<span class="op">+</span>abdomen<span class="op">+</span>thigh<span class="op">+</span>forearm, </span>
<span id="cb33-8"><a href="cross-validation.html#cb33-8" aria-hidden="true"></a>            <span class="dt">data =</span> bodyfat_train)</span>
<span id="cb33-9"><a href="cross-validation.html#cb33-9" aria-hidden="true"></a></span>
<span id="cb33-10"><a href="cross-validation.html#cb33-10" aria-hidden="true"></a>mod2 &lt;-<span class="st"> </span><span class="kw">fit</span>(lm_spec,</span>
<span id="cb33-11"><a href="cross-validation.html#cb33-11" aria-hidden="true"></a>            fatSiri <span class="op">~</span><span class="st"> </span>age<span class="op">+</span>weight<span class="op">+</span>neck<span class="op">+</span>abdomen<span class="op">+</span>thigh<span class="op">+</span>forearm<span class="op">+</span>biceps, </span>
<span id="cb33-12"><a href="cross-validation.html#cb33-12" aria-hidden="true"></a>            <span class="dt">data =</span> bodyfat_train)</span>
<span id="cb33-13"><a href="cross-validation.html#cb33-13" aria-hidden="true"></a></span>
<span id="cb33-14"><a href="cross-validation.html#cb33-14" aria-hidden="true"></a>mod3 &lt;-<span class="st"> </span><span class="kw">fit</span>(lm_spec,</span>
<span id="cb33-15"><a href="cross-validation.html#cb33-15" aria-hidden="true"></a>            fatSiri <span class="op">~</span><span class="st"> </span>age<span class="op">+</span>weight<span class="op">+</span>neck<span class="op">+</span>abdomen<span class="op">+</span>thigh<span class="op">+</span>forearm<span class="op">+</span>biceps<span class="op">+</span>chest<span class="op">+</span>hip, </span>
<span id="cb33-16"><a href="cross-validation.html#cb33-16" aria-hidden="true"></a>            <span class="dt">data =</span> bodyfat_train)</span>
<span id="cb33-17"><a href="cross-validation.html#cb33-17" aria-hidden="true"></a></span>
<span id="cb33-18"><a href="cross-validation.html#cb33-18" aria-hidden="true"></a>mod4 &lt;-<span class="st"> </span><span class="kw">fit</span>(lm_spec,</span>
<span id="cb33-19"><a href="cross-validation.html#cb33-19" aria-hidden="true"></a>            fatSiri <span class="op">~</span><span class="st"> </span>.,  <span class="co"># The . means all predictors</span></span>
<span id="cb33-20"><a href="cross-validation.html#cb33-20" aria-hidden="true"></a>            <span class="dt">data =</span> bodyfat_train) </span></code></pre></div>
<p><br></p>
<div id="exercise-1-cross-validation-concepts" class="section level3 unnumbered hasAnchor">
<h3>Exercise 1: Cross-validation concepts<a href="cross-validation.html#exercise-1-cross-validation-concepts" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s conceptually step through exactly what our code will be doing to perform 10-fold cross-validation (CV) on the 80 cases in the training set. In your groups, take turns explaining these steps.</p>
<p><br></p>
</div>
<div id="exercise-2-cross-validation-with-tidymodels" class="section level3 unnumbered hasAnchor">
<h3>Exercise 2: Cross-validation with <code>tidymodels</code><a href="cross-validation.html#exercise-2-cross-validation-with-tidymodels" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: lower-alpha">
<li>The code below performs 10-fold CV for <code>mod1</code> to estimate the test RMSE (<span class="math inline">\(\text{CV}_{(10)}\)</span>). Do we need to use <code>set.seed()</code>? Why or why not? (Is there a number of folds for which we would not need to set the seed?)</li>
</ol>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="cross-validation.html#cb34-1" aria-hidden="true"></a><span class="co"># Do we need to use set.seed()?</span></span>
<span id="cb34-2"><a href="cross-validation.html#cb34-2" aria-hidden="true"></a></span>
<span id="cb34-3"><a href="cross-validation.html#cb34-3" aria-hidden="true"></a>bodyfat_cv &lt;-<span class="st"> </span><span class="kw">vfold_cv</span>(bodyfat_train, <span class="dt">v =</span> <span class="dv">10</span>)</span>
<span id="cb34-4"><a href="cross-validation.html#cb34-4" aria-hidden="true"></a></span>
<span id="cb34-5"><a href="cross-validation.html#cb34-5" aria-hidden="true"></a>model_wf &lt;-<span class="st"> </span><span class="kw">workflow</span>() <span class="op">%&gt;%</span></span>
<span id="cb34-6"><a href="cross-validation.html#cb34-6" aria-hidden="true"></a><span class="st">    </span><span class="kw">add_formula</span>(fatSiri <span class="op">~</span><span class="st"> </span>age<span class="op">+</span>weight<span class="op">+</span>neck<span class="op">+</span>abdomen<span class="op">+</span>thigh<span class="op">+</span>forearm) <span class="op">%&gt;%</span></span>
<span id="cb34-7"><a href="cross-validation.html#cb34-7" aria-hidden="true"></a><span class="st">    </span><span class="kw">add_model</span>(lm_spec)</span>
<span id="cb34-8"><a href="cross-validation.html#cb34-8" aria-hidden="true"></a></span>
<span id="cb34-9"><a href="cross-validation.html#cb34-9" aria-hidden="true"></a>mod1_cv &lt;-<span class="st"> </span><span class="kw">fit_resamples</span>(model_wf,</span>
<span id="cb34-10"><a href="cross-validation.html#cb34-10" aria-hidden="true"></a>    <span class="dt">resamples =</span> bodyfat_cv, </span>
<span id="cb34-11"><a href="cross-validation.html#cb34-11" aria-hidden="true"></a>    <span class="dt">metrics =</span> <span class="kw">metric_set</span>(rmse, mae, rsq)</span>
<span id="cb34-12"><a href="cross-validation.html#cb34-12" aria-hidden="true"></a>)</span></code></pre></div>
<ol start="2" style="list-style-type: lower-alpha">
<li>Explore <code>mod1_cv %&gt;% unnest(.metrics)</code>. What information seems to be contained in this output, and how would you use this to calculate the 10-fold cross-validated RMSE by hand? (If you feel up to it, try using code to perform this calculation–use <code>filter()</code> and <code>summarize()</code>.)</li>
</ol>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="cross-validation.html#cb35-1" aria-hidden="true"></a>mod1_cv <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unnest</span>(.metrics)</span></code></pre></div>
<ol start="3" style="list-style-type: lower-alpha">
<li>Check your manual calculation by directly printing out the CV metrics: <code>mod1_cv %&gt;% collect_metrics()</code>. Interpret this metric.</li>
</ol>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="cross-validation.html#cb36-1" aria-hidden="true"></a>mod1_cv <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">collect_metrics</span>()</span></code></pre></div>
<p><br></p>
</div>
<div id="exercise-3-looking-at-the-evaluation-metrics" class="section level3 unnumbered hasAnchor">
<h3>Exercise 3: Looking at the evaluation metrics<a href="cross-validation.html#exercise-3-looking-at-the-evaluation-metrics" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Look at the completed table below of evaluation metrics for the 4 models.</p>
<ol style="list-style-type: lower-alpha">
<li>Which model performed the best on the training data?</li>
<li>Which model performed best on test set (through CV)?</li>
<li>Explain why there’s a discrepancy between these 2 answers and why CV, in general, can help prevent overfitting.</li>
</ol>
<table>
<thead>
<tr class="header">
<th align="left">Model</th>
<th align="center">Training RMSE</th>
<th align="center"><span class="math inline">\(\text{CV}_{(10)}\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>mod1</code></td>
<td align="center">3.810712</td>
<td align="center">4.389568</td>
</tr>
<tr class="even">
<td align="left"><code>mod2</code></td>
<td align="center">3.766645</td>
<td align="center">4.438637</td>
</tr>
<tr class="odd">
<td align="left"><code>mod3</code></td>
<td align="center">3.752362</td>
<td align="center">4.517281</td>
</tr>
<tr class="even">
<td align="left"><code>mod4</code></td>
<td align="center">3.572299</td>
<td align="center">4.543343</td>
</tr>
</tbody>
</table>
<p><br></p>
</div>
<div id="exercise-4-practical-issues-choosing-the-number-of-folds" class="section level3 unnumbered hasAnchor">
<h3>Exercise 4: Practical issues: choosing the number of folds<a href="cross-validation.html#exercise-4-practical-issues-choosing-the-number-of-folds" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: lower-alpha">
<li>In terms of sample size, what are the pros/cons of low vs. high number of folds?</li>
<li>In terms of computational time, what are the pros/cons of low vs. high number of folds?</li>
<li>If possible, it is advisable to choose the number of folds to be a divisor of the sample size. Why do you think that is?</li>
</ol>
<p><br></p>
</div>
<div id="digging-deeper" class="section level3 unnumbered hasAnchor">
<h3>Digging deeper<a href="cross-validation.html#digging-deeper" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>If you have time, consider the following questions to further explore concepts related to today’s ideas.</p>
<p>Consider leave-one-out-cross-validation (LOOCV).</p>
<ul>
<li>Would we need <code>set.seed()</code>? Why or why not?</li>
<li>How might you adapt the code above to implement this?</li>
<li>Using the information from <code>your_output %&gt;% unnest(.metrics)</code> (which is a dataset), construct a visualization to examine the variability of RMSE from case to case. What might explain any very large values? What does this highlight about the quality of estimation of the LOOCV process?</li>
</ul>

</div>
</div>
</div>



            </section>

          </div>
        </div>
      </div>
<a href="overfitting.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="homework-1.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
